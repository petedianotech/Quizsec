
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the MindSprint Daily game.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "username": {
          "type": "string",
          "description": "The username of the user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the user account was created.",
          "format": "date-time"
        },
        "campaignProgress": {
          "type": "object",
          "description": "Tracks the user's progress through the campaign seasons and levels.",
          "additionalProperties": {
            "$ref": "#/backend/entities/UserLevelProgress"
          }
        }
      },
      "required": [
        "id",
        "username",
        "email",
        "createdAt"
      ]
    },
    "Quiz": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Quiz",
      "type": "object",
      "description": "Represents a quiz in the MindSprint Daily game.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the quiz (YYYY-MM-DD format)."
        },
        "questions": {
          "type": "array",
          "description": "An array of question objects for the quiz.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "questions"
      ]
    },
    "Question": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Question",
      "type": "object",
      "description": "Represents a question within a quiz.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the question."
        },
        "questionText": {
          "type": "string",
          "description": "The text of the question."
        },
        "options": {
          "type": "array",
          "description": "An array of possible answer options.",
          "items": {
            "type": "string"
          }
        },
        "correctIndex": {
          "type": "number",
          "description": "The index of the correct answer option in the options array."
        },
        "difficultyLevel": {
          "type": "number",
          "description": "The difficulty level of the question (1-10)."
        },
        "levelId": {
            "type": "string",
            "description": "The ID of the level this question belongs to."
        },
        "seasonId": {
            "type": "string",
            "description": "The ID of the season this question belongs to."
        }
      },
      "required": [
        "id",
        "questionText",
        "options",
        "correctIndex",
        "difficultyLevel"
      ]
    },
    "UserQuizSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserQuizSession",
      "type": "object",
      "description": "Represents a user's session playing a specific quiz.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user quiz session."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N UserQuizSession)"
        },
        "quizId": {
          "type": "string",
          "description": "Reference to Quiz. (Relationship: Quiz 1:N UserQuizSession)"
        },
        "levelId": {
            "type": "string",
            "description": "The ID of the level played in this session."
        },
        "seasonId": {
            "type": "string",
            "description": "The ID of the season played in this session."
        },
        "startTime": {
          "type": "string",
          "description": "Timestamp indicating when the user started the quiz session.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "Timestamp indicating when the user finished the quiz session.",
          "format": "date-time"
        },
        "score": {
          "type": "number",
          "description": "The user's score for the quiz session."
        }
      },
      "required": [
        "id",
        "userId",
        "quizId",
        "startTime",
        "endTime",
        "score"
      ]
    },
    "Season": {
      "title": "Season",
      "type": "object",
      "description": "Represents a campaign season containing multiple levels.",
      "properties": {
        "id": {
          "type": "string"
        },
        "seasonNumber": {
          "type": "number"
        },
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "required": ["id", "seasonNumber", "title"]
    },
    "Level": {
      "title": "Level",
      "type": "object",
      "description": "Represents a level within a season.",
      "properties": {
        "id": {
          "type": "string"
        },
        "levelNumber": {
          "type": "number"
        },
        "seasonId": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "required": ["id", "levelNumber", "seasonId", "title"]
    },
    "UserLevelProgress": {
      "title": "UserLevelProgress",
      "type": "object",
      "description": "Represents a user's progress in a specific level.",
      "properties": {
        "levelId": {
          "type": "string"
        },
        "seasonId": {
          "type": "string"
        },
        "score": {
          "type": "number"
        },
        "completed": {
          "type": "boolean"
        },
        "unlocked": {
            "type": "boolean"
        }
      },
      "required": ["levelId", "seasonId", "score", "completed", "unlocked"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles and their campaign progress.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/userQuizSessions/{sessionId}",
        "definition": {
          "entityName": "UserQuizSession",
          "schema": {
            "$ref": "#/backend/entities/UserQuizSession"
          },
          "description": "Stores user's quiz sessions for both daily and campaign modes.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            },
            {
              "name": "sessionId",
              "description": "Unique identifier for the user quiz session."
            }
          ]
        }
      },
      {
        "path": "/seasons/{seasonId}",
        "definition": {
          "entityName": "Season",
          "schema": { "$ref": "#/backend/entities/Season" },
          "description": "Stores the campaign seasons."
        }
      },
      {
        "path": "/seasons/{seasonId}/levels/{levelId}",
        "definition": {
          "entityName": "Level",
          "schema": { "$ref": "#/backend/entities/Level" },
          "description": "Stores the levels for each season."
        }
      },
      {
        "path": "/questions/{questionId}",
        "definition": {
          "entityName": "Question",
          "schema": {
            "$ref": "#/backend/entities/Question"
          },
          "description": "Stores all quiz questions. Questions can be associated with a season and level.",
          "params": [
            {
              "name": "questionId",
              "description": "Unique identifier for the question."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is updated to support a campaign mode with seasons and levels. User progress is tracked within the user's document. This keeps user-specific data isolated and secure. The seasons and levels collections are public content. Questions are now linked to seasons and levels."
  }
}
